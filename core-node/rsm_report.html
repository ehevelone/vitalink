<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>RSM Dashboard</title>
</head>
<body>

<h2>RSM Dashboard</h2>
<button id="logout">Logout</button>

<p>Your Active Agents: <span id="rsmAgents">0</span></p>

<script>
const BACKEND = "https://vitalink-app.netlify.app/.netlify/functions";
const token = sessionStorage.getItem("adminSessionToken");
const role = sessionStorage.getItem("userRole");

if (!token || role !== "rsm") {
  window.location.href = "admin.html";
}

document.getElementById("logout").onclick = () => {
  sessionStorage.clear();
  window.location.href = "admin.html";
};

async function load() {
  const res = await fetch(`${BACKEND}/rsm-summary-report`, {
    headers: { "x-rsm-token": token }
  });

  if (!res.ok) return;

  const data = await res.json();
  document.getElementById("rsmAgents").innerText = data.active_agents;
}

load();
</script>

</body>
</html>
